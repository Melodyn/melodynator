# Melodynator — инструкции для Claude

Перед началом работы прочитай [`CODING_STANDARDS.md`](./CODING_STANDARDS.md).

## Кратко о главном

**Предметная область** — музыкальная теория. Код именуется на языке музыканта. Если неясно, как называется концепция или как она должна работать — спроси у автора проекта, не придумывай.

**Архитектура:**
- `store.ts` — только состояние и действия, ничего про HTML
- `ui.ts` — весь DOM: querySelector, querySelectorAll, шаблоны, domRefs. Любой DOM API в других файлах — ошибка
- `render.ts` — читает store, обновляет DOM **только через refs**. Не мутирует состояние. Никакого DOM API. Переменные именуются по типам из `types/index.ts` — не по позиции в DOM

**Нейминг:** `el` для DOM, `state` для атомов, глаголы для actions. Типы — только в `src/types/index.ts`.

**При старте новой сессии или после сжатия контекста (compaction):** прочитай эти четыре файла — они дают полное представление о проекте без чтения исходников:

1. [`CLAUDE.md`](./CLAUDE.md) — архитектура, правила, запреты (этот файл)
2. [`CODING_STANDARDS.md`](./CODING_STANDARDS.md) — принципы нейминга с примерами
3. [`naming.yaml`](./naming.yaml) — карта всех имён и цепочки от HTML до render.ts
4. [`src/types/index.ts`](./src/types/index.ts) — формы всех типов данных

Исходники (`store.ts`, `ui.ts`, `render.ts`) читай только под конкретную задачу. После прочтения четырёх файлов выше — спроси автора, что нужно делать дальше. Не начинай вносить изменения в код самостоятельно.

**После завершения работы** обновить [`naming.yaml`](./naming.yaml): добавить новые концепции во все релевантные секции, переименованные — обновить везде одновременно. Алгоритм проверки описан в комментарии внутри файла.

**Запрещено:**
- `!` и `?.` — используй `if` или явный каст
- `document.createElement` для структурного DOM — используй `<template>` из HTML
- Глубокая вложенность в одном выражении — бей на константы
